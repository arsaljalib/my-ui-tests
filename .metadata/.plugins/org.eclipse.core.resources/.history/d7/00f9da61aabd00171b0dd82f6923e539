import java.text.SimpleDateFormat;
import java.util.Calendar;
import java.util.Date;
import java.util.List;

import org.openqa.selenium.By;
import org.openqa.selenium.WebDriver;
import org.openqa.selenium.WebElement;
import org.openqa.selenium.support.ui.Select;

public class NotificationTests extends myCommon{
	
	public String FilePath;
	public String CurrentDate;
	
	NotificationTests(WebDriver mydriver,String myAuthToken)  {
		
		 driver=mydriver;
		 AuthToken=myAuthToken;
		 FilePath="/Users/arsaljalib/eclipse-workspace/MyVanidayTestApplication/Files";
		 
		 Calendar cal = Calendar.getInstance();  
		    cal.setTime(new Date());  
		    cal.add(Calendar.DATE, 10); 
		    
			CurrentDate = new SimpleDateFormat("dd-MMM-yyyy").format(new Date());

		 	ResetAppointments(new SimpleDateFormat("yyyy-MM-dd").format( cal.getTime()));
		 ResetClients(AuthToken);
			driver.manage().window().maximize();

	 // ExecuteAllTests(driver, ClientTests.class);

		 //ExecuteSpecificTest("Clients_TestCase_7",ClientTests.class);
		 ExecuteSimilarTests("Notifications_TestCase_1",NotificationTests.class,driver);
	  PrintTestResults();
	}
	
	public void Notifications_TestCase_1() // Enable confirmation email and verify that the email is received (Manual appointment)
	{
		try {
			String ClientName = new Object() {
			}.getClass().getEnclosingMethod().getName();
 			driver.findElement(By.cssSelector("body > ui-view > vm-navbar > div > ul > li:nth-child(9) > a > i")).click();
			Sleep(5);
			
			driver.findElement(By.cssSelector("body > ui-view > ui-view > section > div.tab-content.ng-scope > div > span > ul > li:nth-child(3) > a > span > i")).click();
			Sleep(5);

			driver.findElement(By.cssSelector("body > ui-view > ui-view > section > div.tab-content.ng-scope > div > div > div > ul > li:nth-child(3) > a")).click();
			Sleep(3);
			
			WebElement myButton =driver.findElement(By.cssSelector("#enabled"));
			if(myButton.getClass().toString().contains("checked")!=true)
				myButton.click();
				
			Sleep(5);
			
			driver.findElement(By.cssSelector("body > ui-view > vm-navbar > div > ul > li:nth-child(3) > a > i")).click();
			
			Sleep(5);
			
			driver.findElement(By.cssSelector("body > ui-view > ui-view > section > div > div > div > table > tbody > tr > td > div > div > div.fc-content-skeleton > table > tbody > tr > td:nth-child(2) > div > div.fc-bgevent-container > div:nth-child(1)")).click();
			Sleep(3);
			driver.findElement(By.cssSelector("div.popover-content > vm-calendar-popover > div > a.btn.btn-primary.btn-appointment.with-icon.ng-scope")).click();
			Sleep(3);
			driver.findElement(By.name("customerSearch")).sendKeys("Arsal");

			Sleep(5);
			List<WebElement> listItems = driver.findElements(By.xpath("/html/body/div[7]/div/div/div[2]/div/form/vm-manage-manual-appointment-context/div/div[2]/vm-client-autocomplete/ng-form/div[2]/ul/li/a"));
			listItems.get(0).click();

			driver.findElement(By.name("service")).sendKeys("Manicure");
			Sleep(3);
			listItems = driver.findElements(By.xpath("/html/body/div[7]/div/div/div[2]/div/form/ng-form/vm-manage-manual-appointment-booking-item/div/div[1]/div[1]/div/div[1]/div/div/ul/li/a"));
			listItems.get(0).click();
 
			 driver.findElement(By.id("note")).sendKeys(ClientName);
			
			new Select(driver.findElement(By.id("time"))).selectByVisibleText("01:30 AM");
			new Select(driver.findElement(By.id("duration"))).selectByVisibleText("1h00m");

			
			driver.findElement(By.cssSelector(
					"body > div.manage-calendar-modal.modal.fade.ng-scope.in > div > div > div.manage-calendar-modal__dialog__content__body > div > div > button > span"))
					.click();
			
		 	Sleep(300);
			
			if(VerifyNotificationEmail(CurrentDate,"01:30 am","Thank you for booking an appointment") !=true)
				throw new Exception ("The email was not received");
			
			TestPassed();

		} catch (Exception e) {
			TestFailed(e);
		}
	}
	
	public void Notifications_TestCase_2() // Disable confirmation email and verify that the email is not received (Manual appointment)
	{
		try {
			String ClientName = new Object() {
			}.getClass().getEnclosingMethod().getName();
 			driver.findElement(By.cssSelector("body > ui-view > vm-navbar > div > ul > li:nth-child(9) > a > i")).click();
			Sleep(5);
			
			driver.findElement(By.cssSelector("body > ui-view > ui-view > section > div.tab-content.ng-scope > div > span > ul > li:nth-child(3) > a > span > i")).click();
			Sleep(5);

			driver.findElement(By.cssSelector("body > ui-view > ui-view > section > div.tab-content.ng-scope > div > div > div > ul > li:nth-child(3) > a")).click();
			Sleep(3);
			
			WebElement myButton =driver.findElement(By.cssSelector("#enabled"));
			if(myButton.getClass().toString().contains("checked")!=true)
				myButton.click();
				
			Sleep(5);
			
			driver.findElement(By.cssSelector("body > ui-view > vm-navbar > div > ul > li:nth-child(3) > a > i")).click();
			
			Sleep(5);
			
			driver.findElement(By.cssSelector("body > ui-view > ui-view > section > div > div > div > table > tbody > tr > td > div > div > div.fc-content-skeleton > table > tbody > tr > td:nth-child(2) > div > div.fc-bgevent-container > div:nth-child(1)")).click();
			Sleep(3);
			driver.findElement(By.cssSelector("div.popover-content > vm-calendar-popover > div > a.btn.btn-primary.btn-appointment.with-icon.ng-scope")).click();
			Sleep(3);
			driver.findElement(By.name("customerSearch")).sendKeys("Arsal");

			Sleep(5);
			List<WebElement> listItems = driver.findElements(By.xpath("/html/body/div[7]/div/div/div[2]/div/form/vm-manage-manual-appointment-context/div/div[2]/vm-client-autocomplete/ng-form/div[2]/ul/li/a"));
			listItems.get(0).click();

			driver.findElement(By.name("service")).sendKeys("Manicure");
			Sleep(3);
			listItems = driver.findElements(By.xpath("/html/body/div[7]/div/div/div[2]/div/form/ng-form/vm-manage-manual-appointment-booking-item/div/div[1]/div[1]/div/div[1]/div/div/ul/li/a"));
			listItems.get(0).click();
 
			 driver.findElement(By.id("note")).sendKeys(ClientName);
			
			new Select(driver.findElement(By.id("time"))).selectByVisibleText("01:30 AM");
			new Select(driver.findElement(By.id("duration"))).selectByVisibleText("1h00m");

			
			driver.findElement(By.cssSelector(
					"body > div.manage-calendar-modal.modal.fade.ng-scope.in > div > div > div.manage-calendar-modal__dialog__content__body > div > div > button > span"))
					.click();
			
		 	Sleep(300);
			
			if(VerifyNotificationEmail(CurrentDate,"01:30 am","Thank you for booking an appointment") !=true)
				throw new Exception ("The email was not received");
			
			TestPassed();

		} catch (Exception e) {
			TestFailed(e);
		}
	}
	
	public void Notifications_TestCase_3() // Enable Reschedule email and verify that the email is received (Manual appointment)
	{
		try {
			String ClientName = new Object() {
			}.getClass().getEnclosingMethod().getName();
 			driver.findElement(By.cssSelector("body > ui-view > vm-navbar > div > ul > li:nth-child(9) > a > i")).click();
			Sleep(5);
			
			driver.findElement(By.cssSelector("body > ui-view > ui-view > section > div.tab-content.ng-scope > div > span > ul > li:nth-child(3) > a > span > i")).click();
			Sleep(5);

			driver.findElement(By.cssSelector("body > ui-view > ui-view > section > div.tab-content.ng-scope > div > div > div > ul > li:nth-child(3) > a")).click();
			Sleep(3);
			
			WebElement myButton =driver.findElement(By.cssSelector("#enabled"));
			if(myButton.getClass().toString().contains("checked")!=true)
				myButton.click();
				
			Sleep(5);
			
			driver.findElement(By.cssSelector("body > ui-view > vm-navbar > div > ul > li:nth-child(3) > a > i")).click();
			
			Sleep(5);
			
			driver.findElement(By.cssSelector("body > ui-view > ui-view > section > div > div > div > table > tbody > tr > td > div > div > div.fc-content-skeleton > table > tbody > tr > td:nth-child(2) > div > div.fc-bgevent-container > div:nth-child(1)")).click();
			Sleep(3);
			driver.findElement(By.cssSelector("div.popover-content > vm-calendar-popover > div > a.btn.btn-primary.btn-appointment.with-icon.ng-scope")).click();
			Sleep(3);
			driver.findElement(By.name("customerSearch")).sendKeys("Arsal");

			Sleep(5);
			List<WebElement> listItems = driver.findElements(By.xpath("/html/body/div[7]/div/div/div[2]/div/form/vm-manage-manual-appointment-context/div/div[2]/vm-client-autocomplete/ng-form/div[2]/ul/li/a"));
			listItems.get(0).click();

			driver.findElement(By.name("service")).sendKeys("Manicure");
			Sleep(3);
			listItems = driver.findElements(By.xpath("/html/body/div[7]/div/div/div[2]/div/form/ng-form/vm-manage-manual-appointment-booking-item/div/div[1]/div[1]/div/div[1]/div/div/ul/li/a"));
			listItems.get(0).click();
 
			 driver.findElement(By.id("note")).sendKeys(ClientName);
			
			new Select(driver.findElement(By.id("time"))).selectByVisibleText("01:30 AM");
			new Select(driver.findElement(By.id("duration"))).selectByVisibleText("1h00m");

			
			driver.findElement(By.cssSelector(
					"body > div.manage-calendar-modal.modal.fade.ng-scope.in > div > div > div.manage-calendar-modal__dialog__content__body > div > div > button > span"))
					.click();
			
		 	Sleep(300);
			
			if(VerifyNotificationEmail(CurrentDate,"01:30 am","Thank you for booking an appointment") !=true)
				throw new Exception ("The email was not received");
			
			TestPassed();

		} catch (Exception e) {
			TestFailed(e);
		}
	}
	
	public void Notifications_TestCase_4() // Disable reschedule email and verify that the email is not received (Manual appointment)
	{
		try {
			String ClientName = new Object() {
			}.getClass().getEnclosingMethod().getName();
 			driver.findElement(By.cssSelector("body > ui-view > vm-navbar > div > ul > li:nth-child(9) > a > i")).click();
			Sleep(5);
			
			driver.findElement(By.cssSelector("body > ui-view > ui-view > section > div.tab-content.ng-scope > div > span > ul > li:nth-child(3) > a > span > i")).click();
			Sleep(5);

			driver.findElement(By.cssSelector("body > ui-view > ui-view > section > div.tab-content.ng-scope > div > div > div > ul > li:nth-child(3) > a")).click();
			Sleep(3);
			
			WebElement myButton =driver.findElement(By.cssSelector("#enabled"));
			if(myButton.getClass().toString().contains("checked")!=true)
				myButton.click();
				
			Sleep(5);
			
			driver.findElement(By.cssSelector("body > ui-view > vm-navbar > div > ul > li:nth-child(3) > a > i")).click();
			
			Sleep(5);
			
			driver.findElement(By.cssSelector("body > ui-view > ui-view > section > div > div > div > table > tbody > tr > td > div > div > div.fc-content-skeleton > table > tbody > tr > td:nth-child(2) > div > div.fc-bgevent-container > div:nth-child(1)")).click();
			Sleep(3);
			driver.findElement(By.cssSelector("div.popover-content > vm-calendar-popover > div > a.btn.btn-primary.btn-appointment.with-icon.ng-scope")).click();
			Sleep(3);
			driver.findElement(By.name("customerSearch")).sendKeys("Arsal");

			Sleep(5);
			List<WebElement> listItems = driver.findElements(By.xpath("/html/body/div[7]/div/div/div[2]/div/form/vm-manage-manual-appointment-context/div/div[2]/vm-client-autocomplete/ng-form/div[2]/ul/li/a"));
			listItems.get(0).click();

			driver.findElement(By.name("service")).sendKeys("Manicure");
			Sleep(3);
			listItems = driver.findElements(By.xpath("/html/body/div[7]/div/div/div[2]/div/form/ng-form/vm-manage-manual-appointment-booking-item/div/div[1]/div[1]/div/div[1]/div/div/ul/li/a"));
			listItems.get(0).click();
 
			 driver.findElement(By.id("note")).sendKeys(ClientName);
			
			new Select(driver.findElement(By.id("time"))).selectByVisibleText("01:30 AM");
			new Select(driver.findElement(By.id("duration"))).selectByVisibleText("1h00m");

			
			driver.findElement(By.cssSelector(
					"body > div.manage-calendar-modal.modal.fade.ng-scope.in > div > div > div.manage-calendar-modal__dialog__content__body > div > div > button > span"))
					.click();
			
		 	Sleep(300);
			
			if(VerifyNotificationEmail(CurrentDate,"01:30 am","Thank you for booking an appointment") !=true)
				throw new Exception ("The email was not received");
			
			TestPassed();

		} catch (Exception e) {
			TestFailed(e);
		}
	}
	
	public void Notifications_TestCase_5() // Enable cancellation email and verify that the email is received (Manual appointment)
	{
		try {
			String ClientName = new Object() {
			}.getClass().getEnclosingMethod().getName();
 			driver.findElement(By.cssSelector("body > ui-view > vm-navbar > div > ul > li:nth-child(9) > a > i")).click();
			Sleep(5);
			
			driver.findElement(By.cssSelector("body > ui-view > ui-view > section > div.tab-content.ng-scope > div > span > ul > li:nth-child(3) > a > span > i")).click();
			Sleep(5);

			driver.findElement(By.cssSelector("body > ui-view > ui-view > section > div.tab-content.ng-scope > div > div > div > ul > li:nth-child(3) > a")).click();
			Sleep(3);
			
			WebElement myButton =driver.findElement(By.cssSelector("#enabled"));
			if(myButton.getClass().toString().contains("checked")!=true)
				myButton.click();
				
			Sleep(5);
			
			driver.findElement(By.cssSelector("body > ui-view > vm-navbar > div > ul > li:nth-child(3) > a > i")).click();
			
			Sleep(5);
			
			driver.findElement(By.cssSelector("body > ui-view > ui-view > section > div > div > div > table > tbody > tr > td > div > div > div.fc-content-skeleton > table > tbody > tr > td:nth-child(2) > div > div.fc-bgevent-container > div:nth-child(1)")).click();
			Sleep(3);
			driver.findElement(By.cssSelector("div.popover-content > vm-calendar-popover > div > a.btn.btn-primary.btn-appointment.with-icon.ng-scope")).click();
			Sleep(3);
			driver.findElement(By.name("customerSearch")).sendKeys("Arsal");

			Sleep(5);
			List<WebElement> listItems = driver.findElements(By.xpath("/html/body/div[7]/div/div/div[2]/div/form/vm-manage-manual-appointment-context/div/div[2]/vm-client-autocomplete/ng-form/div[2]/ul/li/a"));
			listItems.get(0).click();

			driver.findElement(By.name("service")).sendKeys("Manicure");
			Sleep(3);
			listItems = driver.findElements(By.xpath("/html/body/div[7]/div/div/div[2]/div/form/ng-form/vm-manage-manual-appointment-booking-item/div/div[1]/div[1]/div/div[1]/div/div/ul/li/a"));
			listItems.get(0).click();
 
			 driver.findElement(By.id("note")).sendKeys(ClientName);
			
			new Select(driver.findElement(By.id("time"))).selectByVisibleText("01:30 AM");
			new Select(driver.findElement(By.id("duration"))).selectByVisibleText("1h00m");

			
			driver.findElement(By.cssSelector(
					"body > div.manage-calendar-modal.modal.fade.ng-scope.in > div > div > div.manage-calendar-modal__dialog__content__body > div > div > button > span"))
					.click();
			
		 	Sleep(300);
			
			if(VerifyNotificationEmail(CurrentDate,"01:30 am","Thank you for booking an appointment") !=true)
				throw new Exception ("The email was not received");
			
			TestPassed();

		} catch (Exception e) {
			TestFailed(e);
		}
	}
	
	public void Notifications_TestCase_6() // Disable cancellation email and verify that the email is not received (Manual appointment)
	{
		try {
			String ClientName = new Object() {
			}.getClass().getEnclosingMethod().getName();
 			driver.findElement(By.cssSelector("body > ui-view > vm-navbar > div > ul > li:nth-child(9) > a > i")).click();
			Sleep(5);
			
			driver.findElement(By.cssSelector("body > ui-view > ui-view > section > div.tab-content.ng-scope > div > span > ul > li:nth-child(3) > a > span > i")).click();
			Sleep(5);

			driver.findElement(By.cssSelector("body > ui-view > ui-view > section > div.tab-content.ng-scope > div > div > div > ul > li:nth-child(3) > a")).click();
			Sleep(3);
			
			WebElement myButton =driver.findElement(By.cssSelector("#enabled"));
			if(myButton.getClass().toString().contains("checked")!=true)
				myButton.click();
				
			Sleep(5);
			
			driver.findElement(By.cssSelector("body > ui-view > vm-navbar > div > ul > li:nth-child(3) > a > i")).click();
			
			Sleep(5);
			
			driver.findElement(By.cssSelector("body > ui-view > ui-view > section > div > div > div > table > tbody > tr > td > div > div > div.fc-content-skeleton > table > tbody > tr > td:nth-child(2) > div > div.fc-bgevent-container > div:nth-child(1)")).click();
			Sleep(3);
			driver.findElement(By.cssSelector("div.popover-content > vm-calendar-popover > div > a.btn.btn-primary.btn-appointment.with-icon.ng-scope")).click();
			Sleep(3);
			driver.findElement(By.name("customerSearch")).sendKeys("Arsal");

			Sleep(5);
			List<WebElement> listItems = driver.findElements(By.xpath("/html/body/div[7]/div/div/div[2]/div/form/vm-manage-manual-appointment-context/div/div[2]/vm-client-autocomplete/ng-form/div[2]/ul/li/a"));
			listItems.get(0).click();

			driver.findElement(By.name("service")).sendKeys("Manicure");
			Sleep(3);
			listItems = driver.findElements(By.xpath("/html/body/div[7]/div/div/div[2]/div/form/ng-form/vm-manage-manual-appointment-booking-item/div/div[1]/div[1]/div/div[1]/div/div/ul/li/a"));
			listItems.get(0).click();
 
			 driver.findElement(By.id("note")).sendKeys(ClientName);
			
			new Select(driver.findElement(By.id("time"))).selectByVisibleText("01:30 AM");
			new Select(driver.findElement(By.id("duration"))).selectByVisibleText("1h00m");

			
			driver.findElement(By.cssSelector(
					"body > div.manage-calendar-modal.modal.fade.ng-scope.in > div > div > div.manage-calendar-modal__dialog__content__body > div > div > button > span"))
					.click();
			
		 	Sleep(300);
			
			if(VerifyNotificationEmail(CurrentDate,"01:30 am","Thank you for booking an appointment") !=true)
				throw new Exception ("The email was not received");
			
			TestPassed();

		} catch (Exception e) {
			TestFailed(e);
		}
	}
	
	public void Notifications_TestCase_7() // Enable confirmation email and verify that the email is received (Manual appointment)
	{
		try {
			String ClientName = new Object() {
			}.getClass().getEnclosingMethod().getName();
 			driver.findElement(By.cssSelector("body > ui-view > vm-navbar > div > ul > li:nth-child(9) > a > i")).click();
			Sleep(5);
			
			driver.findElement(By.cssSelector("body > ui-view > ui-view > section > div.tab-content.ng-scope > div > span > ul > li:nth-child(3) > a > span > i")).click();
			Sleep(5);

			driver.findElement(By.cssSelector("body > ui-view > ui-view > section > div.tab-content.ng-scope > div > div > div > ul > li:nth-child(3) > a")).click();
			Sleep(3);
			
			WebElement myButton =driver.findElement(By.cssSelector("#enabled"));
			if(myButton.getClass().toString().contains("checked")!=true)
				myButton.click();
				
			Sleep(5);
			
			driver.findElement(By.cssSelector("body > ui-view > vm-navbar > div > ul > li:nth-child(3) > a > i")).click();
			
			Sleep(5);
			
			driver.findElement(By.cssSelector("body > ui-view > ui-view > section > div > div > div > table > tbody > tr > td > div > div > div.fc-content-skeleton > table > tbody > tr > td:nth-child(2) > div > div.fc-bgevent-container > div:nth-child(1)")).click();
			Sleep(3);
			driver.findElement(By.cssSelector("div.popover-content > vm-calendar-popover > div > a.btn.btn-primary.btn-appointment.with-icon.ng-scope")).click();
			Sleep(3);
			driver.findElement(By.name("customerSearch")).sendKeys("Arsal");

			Sleep(5);
			List<WebElement> listItems = driver.findElements(By.xpath("/html/body/div[7]/div/div/div[2]/div/form/vm-manage-manual-appointment-context/div/div[2]/vm-client-autocomplete/ng-form/div[2]/ul/li/a"));
			listItems.get(0).click();

			driver.findElement(By.name("service")).sendKeys("Manicure");
			Sleep(3);
			listItems = driver.findElements(By.xpath("/html/body/div[7]/div/div/div[2]/div/form/ng-form/vm-manage-manual-appointment-booking-item/div/div[1]/div[1]/div/div[1]/div/div/ul/li/a"));
			listItems.get(0).click();
 
			 driver.findElement(By.id("note")).sendKeys(ClientName);
			
			new Select(driver.findElement(By.id("time"))).selectByVisibleText("01:30 AM");
			new Select(driver.findElement(By.id("duration"))).selectByVisibleText("1h00m");

			
			driver.findElement(By.cssSelector(
					"body > div.manage-calendar-modal.modal.fade.ng-scope.in > div > div > div.manage-calendar-modal__dialog__content__body > div > div > button > span"))
					.click();
			
		 	Sleep(300);
			
			if(VerifyNotificationEmail(CurrentDate,"01:30 am","Thank you for booking an appointment") !=true)
				throw new Exception ("The email was not received");
			
			TestPassed();

		} catch (Exception e) {
			TestFailed(e);
		}
	}
}